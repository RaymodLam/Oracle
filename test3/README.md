# 实验3：创建分区表

## 实验内容：
- 本实验使用3个表空间：USERS,USERS02,USERS03。在表空间中创建两张表：订单表(orders)与订单详表(order_details)。
- 使用**你自己的账号创建本实验的表**，表创建在上述3个分区，自定义分区策略。
- 你需要使用system用户给你自己的账号分配上述分区的使用权限。你需要使用system用户给你的用户分配可以查询执行计划的权限。
- 表创建成功后，插入数据，数据能并平均分布到各个分区。每个表的数据都应该大于1万行，对表进行联合查询。
- 写出插入数据的语句和查询数据的语句，并分析语句的执行计划。
- 进行分区与不分区的对比实验。

##大概过程如下：

1、登陆到自己之前创建的账号：

[oracle@deep02 ~]$ sqlplus sx_user/123@pdborcl

SQL*Plus: Release 12.1.0.2.0 Production on 星期四 11月 8 09:24:17 2018

Copyright (c) 1982, 2014, Oracle.  All rights reserved.

上次成功登录时间: 星期三 10月 24 2018 09:01:34 +08:00

连接到:
Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing opt    ions

SQL>

2、创建orders表：

CREATE TABLE orders
(
 order_id   NUMBER(10, 0)  primary key NOT NULL
 , customer_name VARCHAR2(40 BYTE) NOT NULL
  5   , customer_tel VARCHAR2(40 BYTE) NOT NULL
 , order_date DATE NOT NULL
  7   , employee_id NUMBER(6, 0) NOT NULL
  8   , discount NUMBER(8, 2) DEFAULT 0
 , trade_receivable NUMBER(8, 2) DEFAULT 0
)
 11  TABLESPACE USERS
PCTFREE 10 INITRANS 1
STORAGE (   BUFFER_POOL DEFAULT )
 14  NOCOMPRESS NOPARALLEL
PARTITION BY RANGE (order_date)
(
 17   PARTITION PARTITION_BEFORE_2016 VALUES LESS THAN (
 TO_DATE(' 2016-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS',
 'NLS_CALENDAR=GREGORIAN'))
 NOLOGGING
 21   TABLESPACE USERS
 PCTFREE 10
 STORAGE
 INITRANS 1
 24   STORAGE
(
 INITIAL 8388608
 NEXT 1048576
 MINEXTENTS 1
 29   MAXEXTENTS UNLIMITED
 BUFFER_POOL DEFAULT
)
 32  NOCOMPRESS NO INMEMORY
, PARTITION PARTITION_BEFORE_2017 VALUES LESS THAN (
NOLOGGING
TABLESPACE USERS02
TO_DATE(' 2017-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS',
'NLS_CALENDAR=GREGORIAN'))
NOLOGGING
 37  TABLESPACE USERS02
PCTFREE 10
 39  INITRANS 1
STORAGE
 41  (
INITIAL 8388608
NEXT 1048576
MINEXTENTS 1
MAXEXTENTS UNLIMITED
NOLOGGING
TABLESPACE USERS03
BUFFER_POOL DEFAULT
STORAGE
(
)
MINEXTENTS 1
NOCOMPRESS NO INMEMORY
, PARTITION PARTITION_BEFORE_2018 VALUES LESS THAN (
TO_DATE(' 2018-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS',
'NLS_CALENDAR=GREGORIAN'))
)
NOLOGGING
TABLESPACE USERS03
PCTFREE 10
INITRANS 1
STORAGE
(
INITIAL 8388608
NEXT 1048576
MINEXTENTS 1
MAXEXTENTS UNLIMITED
BUFFER_POOL DEFAULT
)
 64  );

表已创建。

SQL>

3、创建order_details表：

CREATE TABLE order_details
, product_price NUMBER(8, 2) NOT NULL
  2  (
, CONSTRAINT order_details_fk1 FOREIGN KEY  (order_id)
id NUMBER(10, 0) NOT NULL
ENABLE
)
, order_id NUMBER(10, 0) NOT NULL
STORAGE (   BUFFER_POOL DEFAULT )
, product_id VARCHAR2(40 BYTE) NOT NULL
NOCOMPRESS NOPARALLEL
, product_num NUMBER(8, 2) NOT NULL
, product_price NUMBER(8, 2) NOT NULL
, CONSTRAINT order_details_fk1 FOREIGN KEY  (order_id)
REFERENCES orders(order_id)
 10  ENABLE
)
PCTFREE 10
INITRANS 1
TABLESPACE USERS
PCTFREE 10 INITRANS 1
STORAGE (   BUFFER_POOL DEFAULT )
NOCOMPRESS NOPARALLEL
PARTITION BY REFERENCE (order_details_fk1)
 17  (
)
PARTITION PARTITION_BEFORE_2016
NOLOGGING
TABLESPACE USERS
PCTFREE 10
INITRANS 1
PARTITION PARTITION_BEFORE_2017
NOLOGGING
STORAGE
TABLESPACE USERS02
PCTFREE 10
INITRANS 1
(
(
INITIAL 8388608
NEXT 1048576
MINEXTENTS 1
MAXEXTENTS UNLIMITED
BUFFER_POOL DEFAULT
)
NOCOMPRESS NO INMEMORY,
PARTITION PARTITION_BEFORE_2017
PARTITION PARTITION_BEFORE_2018
NOLOGGING
TABLESPACE USERS02
PCTFREE 10
INITRANS 1
TABLESPACE USERS03
STORAGE
 38  (
INITIAL 8388608
INITIAL 8388608
NEXT 1048576
MINEXTENTS 1
MAXEXTENTS UNLIMITED
BUFFER_POOL DEFAULT
BUFFER_POOL DEFAULT
)
NOCOMPRESS NO INMEMORY,
)
PARTITION PARTITION_BEFORE_2018
NOLOGGING
TABLESPACE USERS03
PCTFREE 10
INITRANS 1
 51  STORAGE
(
INITIAL 8388608
 54  NEXT 1048576
MINEXTENTS 1
MAXEXTENTS UNLIMITED
BUFFER_POOL DEFAULT
)
 59  );

表已创建。

SQL>


